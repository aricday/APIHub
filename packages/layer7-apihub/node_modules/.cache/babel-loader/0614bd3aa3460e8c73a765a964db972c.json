{"ast":null,"code":"import _objectSpread from\"/Users/aricday/Projects/APIHub/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/aricday/Projects/APIHub/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect}from'react';import{SimpleForm,DateField,TextField,TextInput,useUpdate,useNotify,required,CRUD_UPDATE}from'react-admin';import{makeStyles}from'@material-ui/core';import{MarkdownInput}from'../../ui';import{DocumentFormToolbar}from'./DocumentFormToolbar';var useStyles=makeStyles(function(theme){return{title:{display:'inline-block',width:'30%'},navtitle:{display:'inline-block',marginLeft:theme.spacing(4),width:'30%'},modifyTs:{display:'inline-block',marginLeft:theme.spacing(4),width:'30%'},markdown:{width:'100%'}};});var DocumentForm=function DocumentForm(_ref){var _ref$record=_ref.record,record=_ref$record===void 0?{}:_ref$record,_ref$loading=_ref.loading,loading=_ref$loading===void 0?false:_ref$loading,_ref$error=_ref.error,error=_ref$error===void 0?null:_ref$error,_ref$onSave=_ref.onSave,onSave=_ref$onSave===void 0?function(){}:_ref$onSave,_ref$onCancel=_ref.onCancel,onCancel=_ref$onCancel===void 0?function(){}:_ref$onCancel;var classes=useStyles();return React.createElement(SimpleForm,{resource:\"documents\",record:record,toolbar:React.createElement(DocumentFormToolbar,{loading:loading,error:error,onCancel:onCancel}),save:onSave},React.createElement(TextInput,{source:\"title\",formClassName:classes.title,validate:required()}),React.createElement(TextField,{source:\"navtitle\",formClassName:classes.navtitle}),React.createElement(DateField,{source:\"modifyTs\",formClassName:classes.modifyTs}),React.createElement(MarkdownInput,{source:\"markdown\",formClassName:classes.markdown,validate:required(),isRequired:true,fullWidth:true}));};export var DocumentEditForm=function DocumentEditForm(_ref2){var document=_ref2.document,_ref2$onSave=_ref2.onSave,onSave=_ref2$onSave===void 0?function(){}:_ref2$onSave,_ref2$onCancel=_ref2.onCancel,onCancel=_ref2$onCancel===void 0?function(){}:_ref2$onCancel;var notify=useNotify();var _useUpdate=useUpdate('documents'),_useUpdate2=_slicedToArray(_useUpdate,2),update=_useUpdate2[0],_useUpdate2$=_useUpdate2[1],data=_useUpdate2$.data,loading=_useUpdate2$.loading,error=_useUpdate2$.error;var handleSave=function handleSave(newDocument){update({payload:{id:document.id,data:_objectSpread({},newDocument,{id:document.id})}},{action:CRUD_UPDATE,onSuccess:function onSuccess(){notify('resources.documents.notifications.edit_success');},onFailure:function onFailure(){notify('resources.documents.notifications.edit_error');}});};useEffect(function(){if(data&&data.uuid){onSave(data);}},[data,onSave]);return React.createElement(DocumentForm,{record:document,loading:loading,error:error,onSave:handleSave,onCancel:onCancel});};DocumentEditForm.__docgenInfo={\"description\":\"\",\"methods\":[],\"displayName\":\"DocumentEditForm\",\"props\":{\"onSave\":{\"defaultValue\":{\"value\":\"() => {}\",\"computed\":false},\"required\":false},\"onCancel\":{\"defaultValue\":{\"value\":\"() => {}\",\"computed\":false},\"required\":false}}};if(typeof STORYBOOK_REACT_CLASSES!==\"undefined\"){STORYBOOK_REACT_CLASSES[\"src/apis/Documentation/DocumentEditForm.js\"]={name:\"DocumentEditForm\",docgenInfo:DocumentEditForm.__docgenInfo,path:\"src/apis/Documentation/DocumentEditForm.js\"};}","map":{"version":3,"sources":["/Users/aricday/Projects/APIHub/packages/layer7-apihub/src/apis/Documentation/DocumentEditForm.js"],"names":["React","useEffect","SimpleForm","DateField","TextField","TextInput","useUpdate","useNotify","required","CRUD_UPDATE","makeStyles","MarkdownInput","DocumentFormToolbar","useStyles","theme","title","display","width","navtitle","marginLeft","spacing","modifyTs","markdown","DocumentForm","record","loading","error","onSave","onCancel","classes","DocumentEditForm","document","notify","update","data","handleSave","newDocument","payload","id","action","onSuccess","onFailure","uuid"],"mappings":"ySAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OACIC,UADJ,CAEIC,SAFJ,CAGIC,SAHJ,CAIIC,SAJJ,CAKIC,SALJ,CAMIC,SANJ,CAOIC,QAPJ,CAQIC,WARJ,KASO,aATP,CAUA,OAASC,UAAT,KAA2B,mBAA3B,CAEA,OAASC,aAAT,KAA8B,UAA9B,CACA,OAASC,mBAAT,KAAoC,uBAApC,CAEA,GAAMC,CAAAA,SAAS,CAAGH,UAAU,CAAC,SAAAI,KAAK,QAAK,CACnCC,KAAK,CAAE,CACHC,OAAO,CAAE,cADN,CAEHC,KAAK,CAAE,KAFJ,CAD4B,CAKnCC,QAAQ,CAAE,CACNF,OAAO,CAAE,cADH,CAENG,UAAU,CAAEL,KAAK,CAACM,OAAN,CAAc,CAAd,CAFN,CAGNH,KAAK,CAAE,KAHD,CALyB,CAUnCI,QAAQ,CAAE,CACNL,OAAO,CAAE,cADH,CAENG,UAAU,CAAEL,KAAK,CAACM,OAAN,CAAc,CAAd,CAFN,CAGNH,KAAK,CAAE,KAHD,CAVyB,CAenCK,QAAQ,CAAE,CACNL,KAAK,CAAE,MADD,CAfyB,CAAL,EAAN,CAA5B,CAoBA,GAAMM,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAMf,sBALFC,MAKE,CALFA,MAKE,sBALO,EAKP,+BAJFC,OAIE,CAJFA,OAIE,uBAJQ,KAIR,8BAHFC,KAGE,CAHFA,KAGE,qBAHM,IAGN,6BAFFC,MAEE,CAFFA,MAEE,sBAFO,UAAM,CAAE,CAEf,gCADFC,QACE,CADFA,QACE,wBADS,UAAM,CAAE,CACjB,eACF,GAAMC,CAAAA,OAAO,CAAGhB,SAAS,EAAzB,CAEA,MACI,qBAAC,UAAD,EACI,QAAQ,CAAC,WADb,CAEI,MAAM,CAAEW,MAFZ,CAGI,OAAO,CACH,oBAAC,mBAAD,EACI,OAAO,CAAEC,OADb,CAEI,KAAK,CAAEC,KAFX,CAGI,QAAQ,CAAEE,QAHd,EAJR,CAUI,IAAI,CAAED,MAVV,EAYI,oBAAC,SAAD,EACI,MAAM,CAAC,OADX,CAEI,aAAa,CAAEE,OAAO,CAACd,KAF3B,CAGI,QAAQ,CAAEP,QAAQ,EAHtB,EAZJ,CAiBI,oBAAC,SAAD,EAAW,MAAM,CAAC,UAAlB,CAA6B,aAAa,CAAEqB,OAAO,CAACX,QAApD,EAjBJ,CAkBI,oBAAC,SAAD,EAAW,MAAM,CAAC,UAAlB,CAA6B,aAAa,CAAEW,OAAO,CAACR,QAApD,EAlBJ,CAmBI,oBAAC,aAAD,EACI,MAAM,CAAC,UADX,CAEI,aAAa,CAAEQ,OAAO,CAACP,QAF3B,CAGI,QAAQ,CAAEd,QAAQ,EAHtB,CAII,UAAU,KAJd,CAKI,SAAS,KALb,EAnBJ,CADJ,CA6BH,CAtCD,CAwCA,MAAO,IAAMsB,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,OAI1B,IAHFC,CAAAA,QAGE,OAHFA,QAGE,oBAFFJ,MAEE,CAFFA,MAEE,uBAFO,UAAM,CAAE,CAEf,mCADFC,QACE,CADFA,QACE,yBADS,UAAM,CAAE,CACjB,gBACF,GAAMI,CAAAA,MAAM,CAAGzB,SAAS,EAAxB,CADE,eAGyCD,SAAS,CAAC,WAAD,CAHlD,0CAGK2B,MAHL,4CAGeC,IAHf,cAGeA,IAHf,CAGqBT,OAHrB,cAGqBA,OAHrB,CAG8BC,KAH9B,cAG8BA,KAH9B,CAKF,GAAMS,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAAAC,WAAW,CAAI,CAC9BH,MAAM,CACF,CACII,OAAO,CAAE,CACLC,EAAE,CAAEP,QAAQ,CAACO,EADR,CAELJ,IAAI,kBAAOE,WAAP,EAAoBE,EAAE,CAAEP,QAAQ,CAACO,EAAjC,EAFC,CADb,CADE,CAOF,CACIC,MAAM,CAAE9B,WADZ,CAEI+B,SAAS,CAAE,oBAAM,CACbR,MAAM,CAAC,gDAAD,CAAN,CACH,CAJL,CAKIS,SAAS,CAAE,oBAAM,CACbT,MAAM,CAAC,8CAAD,CAAN,CACH,CAPL,CAPE,CAAN,CAiBH,CAlBD,CAoBA/B,SAAS,CAAC,UAAM,CACZ,GAAIiC,IAAI,EAAIA,IAAI,CAACQ,IAAjB,CAAuB,CACnBf,MAAM,CAACO,IAAD,CAAN,CACH,CACJ,CAJQ,CAIN,CAACA,IAAD,CAAOP,MAAP,CAJM,CAAT,CAMA,MACI,qBAAC,YAAD,EACI,MAAM,CAAEI,QADZ,CAEI,OAAO,CAAEN,OAFb,CAGI,KAAK,CAAEC,KAHX,CAII,MAAM,CAAES,UAJZ,CAKI,QAAQ,CAAEP,QALd,EADJ,CASH,CA5CM,C","sourcesContent":["import React, { useEffect } from 'react';\nimport {\n    SimpleForm,\n    DateField,\n    TextField,\n    TextInput,\n    useUpdate,\n    useNotify,\n    required,\n    CRUD_UPDATE,\n} from 'react-admin';\nimport { makeStyles } from '@material-ui/core';\n\nimport { MarkdownInput } from '../../ui';\nimport { DocumentFormToolbar } from './DocumentFormToolbar';\n\nconst useStyles = makeStyles(theme => ({\n    title: {\n        display: 'inline-block',\n        width: '30%',\n    },\n    navtitle: {\n        display: 'inline-block',\n        marginLeft: theme.spacing(4),\n        width: '30%',\n    },\n    modifyTs: {\n        display: 'inline-block',\n        marginLeft: theme.spacing(4),\n        width: '30%',\n    },\n    markdown: {\n        width: '100%',\n    },\n}));\n\nconst DocumentForm = ({\n    record = {},\n    loading = false,\n    error = null,\n    onSave = () => {},\n    onCancel = () => {},\n}) => {\n    const classes = useStyles();\n\n    return (\n        <SimpleForm\n            resource=\"documents\"\n            record={record}\n            toolbar={\n                <DocumentFormToolbar\n                    loading={loading}\n                    error={error}\n                    onCancel={onCancel}\n                />\n            }\n            save={onSave}\n        >\n            <TextInput\n                source=\"title\"\n                formClassName={classes.title}\n                validate={required()}\n            />\n            <TextField source=\"navtitle\" formClassName={classes.navtitle} />\n            <DateField source=\"modifyTs\" formClassName={classes.modifyTs} />\n            <MarkdownInput\n                source=\"markdown\"\n                formClassName={classes.markdown}\n                validate={required()}\n                isRequired\n                fullWidth\n            />\n        </SimpleForm>\n    );\n};\n\nexport const DocumentEditForm = ({\n    document,\n    onSave = () => {},\n    onCancel = () => {},\n}) => {\n    const notify = useNotify();\n\n    const [update, { data, loading, error }] = useUpdate('documents');\n\n    const handleSave = newDocument => {\n        update(\n            {\n                payload: {\n                    id: document.id,\n                    data: { ...newDocument, id: document.id },\n                },\n            },\n            {\n                action: CRUD_UPDATE,\n                onSuccess: () => {\n                    notify('resources.documents.notifications.edit_success');\n                },\n                onFailure: () => {\n                    notify('resources.documents.notifications.edit_error');\n                },\n            }\n        );\n    };\n\n    useEffect(() => {\n        if (data && data.uuid) {\n            onSave(data);\n        }\n    }, [data, onSave]);\n\n    return (\n        <DocumentForm\n            record={document}\n            loading={loading}\n            error={error}\n            onSave={handleSave}\n            onCancel={onCancel}\n        />\n    );\n};\n"]},"metadata":{},"sourceType":"module"}
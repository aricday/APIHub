{"ast":null,"code":"import _defineProperty from\"/Users/aricday/Projects/APIHub/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/aricday/Projects/APIHub/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import React from'react';import{required,minLength,maxLength,SimpleForm,TextInput,useTranslate}from'react-admin';import{makeStyles,Typography,InputAdornment}from'@material-ui/core';import{InfoOutlined}from'@material-ui/icons';import{FORM_ERROR}from'final-form';import{useApiHub}from'../../ApiHubContext';import{HtmlTooltip,PasswordInput}from'../../ui';import{TermsInput}from'./TermsInput';import{AccountSetupToolbar}from'./AccountSetupToolbar';import{validatePassword}from'../validatePassword';import{checkUsernameUnicity}from'./useAccountData';var mustBeTrue=function mustBeTrue(){return function(value){return!value?'apihub.account_setup.terms_of_use.terms_of_use_validation':undefined;};};var checkUnicity=function checkUnicity(url){return function _callee(value){return _regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(value.length<6)){_context.next=2;break;}return _context.abrupt(\"return\");case 2:_context.prev=2;_context.next=5;return _regeneratorRuntime.awrap(checkUsernameUnicity(url,value));case 5:_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](2);return _context.abrupt(\"return\",'apihub.account_setup.validation.error_username_not_unique');case 10:case\"end\":return _context.stop();}}},null,null,[[2,7]]);};};var useStyles=makeStyles(function(theme){return{form:{'& >:first-child':{padding:0},'& .ra-input':{marginTop:theme.spacing(2)}},title:{fontSize:theme.typography.fontSize*2,marginBottom:theme.spacing(6),color:theme.palette.getContrastText(theme.palette.background[\"default\"])}};});export var AccountSetupForm=function AccountSetupForm(_ref){var initialValues=_ref.initialValues,onSubmit=_ref.onSubmit;var classes=useStyles();var translate=useTranslate();var _useApiHub=useApiHub(),urlWithApi=_useApiHub.urlWithApi;var validate=function validate(_ref2){var password=_ref2.password,confirm_password=_ref2.confirm_password;if(password!==confirm_password){return _defineProperty({},FORM_ERROR,'apihub.account_setup.validation.error_password_match');}};return React.createElement(React.Fragment,null,React.createElement(Typography,{variant:\"h2\",className:classes.title},translate('apihub.account_setup.title')),React.createElement(SimpleForm,{className:classes.form,save:onSubmit,toolbar:React.createElement(AccountSetupToolbar,null),validate:validate,initialValues:initialValues},React.createElement(TextInput,{source:\"firstName\",type:\"text\",label:\"apihub.account_setup.fields.firstname\",variant:\"outlined\",fullWidth:true,validate:required()}),React.createElement(TextInput,{source:\"lastName\",type:\"text\",label:\"apihub.account_setup.fields.lastname\",variant:\"outlined\",fullWidth:true,validate:required()}),React.createElement(TextInput,{source:\"email\",type:\"email\",label:\"apihub.account_setup.fields.email\",variant:\"outlined\",fullWidth:true,validate:required(),disabled:true}),React.createElement(TextInput,{source:\"userName\",type:\"text\",label:\"apihub.account_setup.fields.username\",variant:\"outlined\",autoComplete:\"new_username\",fullWidth:true,InputProps:{endAdornment:React.createElement(InputAdornment,{position:\"end\"},React.createElement(HtmlTooltip,{className:classes.tootip,title:translate('apihub.tooltip_username'),placement:\"right\",arrow:true},React.createElement(InfoOutlined,null)))},validate:[required(),minLength(6),maxLength(60),checkUnicity(urlWithApi)]}),React.createElement(PasswordInput,{source:\"password\",label:\"apihub.account_setup.fields.password\",variant:\"outlined\",autoComplete:\"new_password\",fullWidth:true,validate:[required(),validatePassword],title:\"apihub.account_setup.validation.tooltip_password\"}),React.createElement(PasswordInput,{source:\"confirm_password\",label:\"apihub.account_setup.fields.confirm_password\",variant:\"outlined\",autoComplete:\"confirm_new_password\",fullWidth:true,validate:[required()],title:\"apihub.account_setup.validation.tooltip_password_confirm\"}),React.createElement(TermsInput,{source:\"terms\",type:\"checkbox\",validate:[mustBeTrue()]})));};AccountSetupForm.__docgenInfo={\"description\":\"\",\"methods\":[],\"displayName\":\"AccountSetupForm\"};if(typeof STORYBOOK_REACT_CLASSES!==\"undefined\"){STORYBOOK_REACT_CLASSES[\"src/authentication/AccountSetup/AccountSetupForm.js\"]={name:\"AccountSetupForm\",docgenInfo:AccountSetupForm.__docgenInfo,path:\"src/authentication/AccountSetup/AccountSetupForm.js\"};}","map":{"version":3,"sources":["/Users/aricday/Projects/APIHub/packages/layer7-apihub/src/authentication/AccountSetup/AccountSetupForm.js"],"names":["React","required","minLength","maxLength","SimpleForm","TextInput","useTranslate","makeStyles","Typography","InputAdornment","InfoOutlined","FORM_ERROR","useApiHub","HtmlTooltip","PasswordInput","TermsInput","AccountSetupToolbar","validatePassword","checkUsernameUnicity","mustBeTrue","value","undefined","checkUnicity","url","length","useStyles","theme","form","padding","marginTop","spacing","title","fontSize","typography","marginBottom","color","palette","getContrastText","background","AccountSetupForm","initialValues","onSubmit","classes","translate","urlWithApi","validate","password","confirm_password","endAdornment","tootip"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {\n    required,\n    minLength,\n    maxLength,\n    SimpleForm,\n    TextInput,\n    useTranslate,\n} from 'react-admin';\nimport { makeStyles, Typography, InputAdornment } from '@material-ui/core';\nimport { InfoOutlined } from '@material-ui/icons';\nimport { FORM_ERROR } from 'final-form';\n\nimport { useApiHub } from '../../ApiHubContext';\nimport { HtmlTooltip, PasswordInput } from '../../ui';\nimport { TermsInput } from './TermsInput';\nimport { AccountSetupToolbar } from './AccountSetupToolbar';\nimport { validatePassword } from '../validatePassword';\nimport { checkUsernameUnicity } from './useAccountData';\n\nconst mustBeTrue = () => value =>\n    !value\n        ? 'apihub.account_setup.terms_of_use.terms_of_use_validation'\n        : undefined;\n\nconst checkUnicity = url => async value => {\n    if (value.length < 6) {\n        return;\n    }\n\n    try {\n        await checkUsernameUnicity(url, value);\n    } catch {\n        return 'apihub.account_setup.validation.error_username_not_unique';\n    }\n};\n\nconst useStyles = makeStyles(theme => ({\n    form: {\n        '& >:first-child': {\n            padding: 0,\n        },\n        '& .ra-input': {\n            marginTop: theme.spacing(2),\n        },\n    },\n    title: {\n        fontSize: theme.typography.fontSize * 2,\n        marginBottom: theme.spacing(6),\n        color: theme.palette.getContrastText(theme.palette.background.default),\n    },\n}));\n\nexport const AccountSetupForm = ({ initialValues, onSubmit }) => {\n    const classes = useStyles();\n    const translate = useTranslate();\n    const { urlWithApi } = useApiHub();\n\n    const validate = ({ password, confirm_password }) => {\n        if (password !== confirm_password) {\n            return {\n                [FORM_ERROR]:\n                    'apihub.account_setup.validation.error_password_match',\n            };\n        }\n    };\n\n    return (\n        <>\n            <Typography variant=\"h2\" className={classes.title}>\n                {translate('apihub.account_setup.title')}\n            </Typography>\n\n            <SimpleForm\n                className={classes.form}\n                save={onSubmit}\n                toolbar={<AccountSetupToolbar />}\n                validate={validate}\n                initialValues={initialValues}\n            >\n                <TextInput\n                    source=\"firstName\"\n                    type=\"text\"\n                    label=\"apihub.account_setup.fields.firstname\"\n                    variant=\"outlined\"\n                    fullWidth\n                    validate={required()}\n                />\n                <TextInput\n                    source=\"lastName\"\n                    type=\"text\"\n                    label=\"apihub.account_setup.fields.lastname\"\n                    variant=\"outlined\"\n                    fullWidth\n                    validate={required()}\n                />\n                <TextInput\n                    source=\"email\"\n                    type=\"email\"\n                    label=\"apihub.account_setup.fields.email\"\n                    variant=\"outlined\"\n                    fullWidth\n                    validate={required()}\n                    disabled\n                />\n                <TextInput\n                    source=\"userName\"\n                    type=\"text\"\n                    label=\"apihub.account_setup.fields.username\"\n                    variant=\"outlined\"\n                    autoComplete=\"new_username\"\n                    fullWidth\n                    InputProps={{\n                        endAdornment: (\n                            <InputAdornment position=\"end\">\n                                <HtmlTooltip\n                                    className={classes.tootip}\n                                    title={translate('apihub.tooltip_username')}\n                                    placement=\"right\"\n                                    arrow\n                                >\n                                    <InfoOutlined />\n                                </HtmlTooltip>\n                            </InputAdornment>\n                        ),\n                    }}\n                    validate={[\n                        required(),\n                        minLength(6),\n                        maxLength(60),\n                        checkUnicity(urlWithApi),\n                    ]}\n                />\n                <PasswordInput\n                    source=\"password\"\n                    label=\"apihub.account_setup.fields.password\"\n                    variant=\"outlined\"\n                    autoComplete=\"new_password\"\n                    fullWidth\n                    validate={[required(), validatePassword]}\n                    title=\"apihub.account_setup.validation.tooltip_password\"\n                />\n                <PasswordInput\n                    source=\"confirm_password\"\n                    label=\"apihub.account_setup.fields.confirm_password\"\n                    variant=\"outlined\"\n                    autoComplete=\"confirm_new_password\"\n                    fullWidth\n                    validate={[required()]}\n                    title=\"apihub.account_setup.validation.tooltip_password_confirm\"\n                />\n                <TermsInput\n                    source=\"terms\"\n                    type=\"checkbox\"\n                    validate={[mustBeTrue()]}\n                />\n            </SimpleForm>\n        </>\n    );\n};\n"]},"metadata":{},"sourceType":"module"}
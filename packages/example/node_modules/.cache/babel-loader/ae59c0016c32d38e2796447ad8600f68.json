{"ast":null,"code":"import _slicedToArray from \"/Users/aricday/Projects/APIHub/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport React, { useState, Children, cloneElement, useEffect, forwardRef } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport ArrowDropDownIcon from '@material-ui/icons/ArrowDropDown';\nimport SortIcon from '@material-ui/icons/Sort';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { shallowEqual, useDispatch, useSelector } from 'react-redux';\nimport { changeListParams, useTranslate } from 'ra-core';\nimport { useHistory } from 'react-router-dom';\nimport { stringify } from 'query-string';\n/**\n * A sort button to use on a list which does not display a datagrid.\n *\n * @param {String} resource The resource on which to apply the sort\n * @param {Object} currentSort The current sort\n * @param {Object} currentSort.field The currently sorted field (eg: \"name\")\n * @param {Object} currentSort.order The current sort order (eg: \"ASC\")\n *\n * @example <caption>Usage inside a custom toolbar for a <List></caption>\n * import { TopToolbar } from 'react-admin';\n *\n * const ApiListActions = ({\n *     currentSort, // injected by react-admin\n *     resource, // injected by react-admin\n *     ...props\n * }) => {\n *     return (\n *         <TopToolbar\n *             className={classnames(classes.root, className)}\n *             {...sanitizeListRestProps(props)}\n *         >\n *             <SortButton resource={resource} currentSort={currentSort}>\n *                 <SortMenuItem\n *                     label=\"resources.apis.list.sort.name.asc\" // Will be translated\n *                     sort={{ field: 'name', order: 'ASC' }}\n *                 />\n *                 <SortMenuItem\n *                     label=\"resources.apis.list.sort.name.desc\" // Will be translated\n *                     sort={{ field: 'name', order: 'DESC' }}\n *                 />\n *             </SortButton>\n *         </TopToolbar>\n *     );\n * };\n */\n\nexport const SortButton = ({\n  children,\n  resource,\n  currentSort\n}) => {\n  const _useState = useState(),\n        _useState2 = _slicedToArray(_useState, 2),\n        currentSortLabel = _useState2[0],\n        setCurrentSortLabel = _useState2[1];\n\n  const _useState3 = useState(null),\n        _useState4 = _slicedToArray(_useState3, 2),\n        anchorEl = _useState4[0],\n        setAnchorEl = _useState4[1];\n\n  const translate = useTranslate();\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const classes = useStyles();\n  const listParams = useSelector(reduxState => reduxState.admin.resources[resource] ? reduxState.admin.resources[resource].list.params : {}, shallowEqual);\n\n  const handleClick = event => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const handleMenuItemClick = (event, sortData) => {\n    history.push({\n      search: `?${stringify(Object.assign(Object.assign({}, listParams), {\n        filter: JSON.stringify(listParams.filter),\n        sort: sortData.sort.field,\n        order: sortData.sort.order\n      }))}`\n    });\n    dispatch(changeListParams(resource, Object.assign(Object.assign({}, listParams), {\n      sort: sortData.sort.field,\n      order: sortData.sort.order\n    })));\n    handleClose();\n  };\n\n  useEffect(() => {\n    const childrenAsArray = Children.toArray(children);\n\n    if (childrenAsArray.length === 0) {\n      return;\n    }\n\n    let selectedChild = childrenAsArray.find(child => child.props.sort.field === currentSort.field && child.props.sort.order === currentSort.order);\n\n    if (!selectedChild) {\n      if (process.env.NODE_ENV !== 'production') {\n        console.warn('The current sort parameters do not match the provided children');\n      }\n\n      selectedChild = childrenAsArray[0];\n    }\n\n    setCurrentSortLabel(translate(selectedChild.props.label));\n  }, [children, currentSort, translate]);\n  return currentSortLabel ? React.createElement(React.Fragment, null, React.createElement(Button, {\n    \"aria-controls\": \"sort-menu\",\n    \"aria-label\": currentSortLabel,\n    \"aria-haspopup\": \"true\",\n    onClick: handleClick,\n    startIcon: React.createElement(SortIcon, null),\n    endIcon: React.createElement(ArrowDropDownIcon, null),\n    className: classes.root,\n    size: \"small\",\n    color: \"primary\"\n  }, currentSortLabel), React.createElement(Menu, {\n    id: \"sort-menu\",\n    anchorEl: anchorEl,\n    keepMounted: true,\n    open: Boolean(anchorEl),\n    onClose: handleClose\n  }, Children.map(children, child => cloneElement(child, Object.assign({\n    onClick: handleMenuItemClick\n  }, child.props))))) : null;\n};\nconst useStyles = makeStyles(theme => ({\n  root: {\n    marginLeft: theme.spacing()\n  }\n}));\nexport const SortMenuItem = forwardRef(({\n  label,\n  sort,\n  onClick\n}, ref) => {\n  const translate = useTranslate();\n\n  const handleClick = event => {\n    onClick(event, {\n      label,\n      sort\n    });\n  };\n\n  return React.createElement(MenuItem, {\n    ref: ref,\n    onClick: handleClick\n  }, translate(label, {\n    _: label\n  }));\n});","map":null,"metadata":{},"sourceType":"module"}